= Λογική αναζήτησης ενοικίασης (για business)

Το έγγραφο εξηγεί πώς λειτουργεί η αναζήτηση διαθεσιμότητας οχημάτων και πώς η διάρκεια ενοικίασης επηρεάζει το τελικό κόστος και τα αποτελέσματα που βλέπει ο πελάτης.

== Τι κάνει η αναζήτηση
. Διαβάζει τις βασικές ρυθμίσεις του συστήματος (όρια, κανόνες έξτρα ωρών, ελάχιστες διάρκειες).
. Υπολογίζει τη διάρκεια της ενοικίασης.
. Βρίσκει τυχόν κόστη διαδρομών (αν επιλεγούν διαφορετικές τοποθεσίες παραλαβής/παράδοσης).
. Ελέγχει τις σεζόν και τις ελάχιστες διάρκειες.
. Φιλτράρει τα διαθέσιμα οχήματα.
. Υπολογίζει το κόστος.
. Επιστρέφει μόνο όσα οχήματα έχουν τελικό κόστος μεγαλύτερο από 0.

== Διάρκεια ενοικίασης και χρέωση
- Η διάρκεια υπολογίζεται σε **ημέρες**.
- Αν η διαφορά είναι λιγότερη από μία ημέρα, μετράει ως **1 ημέρα**.
- Οι **έξτρα ώρες** μπορούν να αυξήσουν τις χρεώσιμες ημέρες, ανάλογα με τον κανόνα που έχει οριστεί.

=== Κανόνες έξτρα ωρών
Υπάρχουν δύο τρόποι:

- **Πλήρης ημέρα (WHOLE_DAY):**
  Αν οι έξτρα ώρες ξεπεράσουν το όριο, προστίθεται μία επιπλέον ημέρα χρέωσης.

- **Ποσοστιαία (PERCENTAGE):**
  Οι έξτρα ώρες χρεώνονται αναλογικά. Αν η χρέωση ξεπεράσει το κόστος μίας ημέρας, τότε μετατρέπεται σε πλήρη ημέρα.

== Ελάχιστη διάρκεια
Η αναζήτηση αποτυγχάνει (δεν εμφανίζει στόλο) αν η διάρκεια είναι μικρότερη από το ελάχιστο που ισχύει.

Η ελάχιστη διάρκεια προκύπτει από:
- τις ελάχιστες διάρκειες ανά σεζόν, και
- τις ελάχιστες διάρκειες ανά τοποθεσία (αν υπάρχουν), ή
- τη γενική ρύθμιση του συστήματος.

== Διαθεσιμότητα οχημάτων
Ένα όχημα θεωρείται διαθέσιμο όταν:
- είναι ενεργό,
- δεν ανήκει σε ομάδα με περίοδο μη διαθεσιμότητας που συμπίπτει με τις ημερομηνίες,
- καλύπτει τα φίλτρα (π.χ. τύπος οχήματος).

== Τιμολόγηση με βάση τις ημέρες
Οι τιμές ανά ομάδα οχημάτων ορίζονται σε **ζώνες ημερών** (D01..D30).

- Για ενοικίαση έως 30 ημέρες, χρησιμοποιείται η αντίστοιχη ζώνη.
- Για διάρκεια **πάνω από 30 ημέρες**, χρησιμοποιείται η τιμή της ζώνης **D30** ως τιμή ημέρας.

Αν λείπει τιμή για το αντίστοιχο band, το κόστος γίνεται 0 και το όχημα δεν εμφανίζεται.

== Εκπτώσεις
Οι εκπτώσεις εφαρμόζονται σύμφωνα με τους κανόνες που υπάρχουν στις σχετικές ρυθμίσεις:
- Εκπτώσεις περιόδου (ανά ημέρα).
- Εκπτώσεις διάρκειας ή προαγοράς (εφάπαξ).

== Πρακτικές επιπτώσεις
- Αν δεν καλύπτεται η ελάχιστη διάρκεια, **δεν επιστρέφονται οχήματα**.
- Αν λείπουν τιμές για το αντίστοιχο band, **δεν επιστρέφονται οχήματα**.
- Για μεγάλες διάρκειες (>30 ημέρες), το σύστημα **κλειδώνει** στην ημερήσια τιμή D30.

== Σχετικά έγγραφα
- xref:booking/discounts.adoc[Εκπτώσεις]
- xref:booking/seasons.adoc[Σεζόν]
- xref:booking/locations.adoc[Τοποθεσίες]
- xref:booking/routes.adoc[Διαδρομές]
- xref:admin/settings-system.adoc[Ρυθμίσεις συστήματος]
- xref:technical/rental-search-logic.adoc[Τεχνική ανάλυση (λεπτομέρειες)]
